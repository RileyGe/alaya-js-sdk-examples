<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <script type="text/javascript"
        src="https://cdn.jsdelivr.net/gh/RileyGe/client-sdk-js@0.11.4/dist/web3a.js"></script>
    <script type="text/javascript">
        function checkAndConnect() {
            // Samurai钱包会向浏览器中注入provider:windows.alaya
            // 如果window.alaya存在，则说明已经安装了Samurai钱包
            if (window.alaya) {
                // 通过向alaya发送platon_requestAccounts请求，来进行Samurai钱包的连接。
                window.alaya.request({
                    method: 'platon_requestAccounts'
                });
                window.pw3 = new PW3(window.alaya);
            } else {
                alert('请安装Samurai')
            }
        }
        function sendATP() {
            let rawTx = {
                from: alaya.selectedAddress,
                to: "atp1886776udz7t32d9vj7sfcqrxugmpnzlj0zrl5x",
                value: 1e16
            }
            pw3.platon.sendTransaction(rawTx, function (err, transactionHash) {
                if (err) {
                    console.log(err);
                } else {
                    console.log(transactionHash);
                }
            });
        }
        function getTransInfo() {
            let transHash = "0x19bc42309dbf96be0a5ca5689fa8b8e1637a7877b9b295c748264162981fb050";
            pw3.platon.getTransaction(transHash).then(function (transInfo) {
                console.log(transInfo);
            });
        }
        function deployContract() {
            // if(pw3 === undefined){
            window.pw3 = new PW3(window.alaya);
            // }
            let contractAbi = [
                {
                    "constant": true,
                    "inputs": [],
                    "name": "getName",
                    "outputs": [
                        {
                            "internalType": "string",
                            "name": "",
                            "type": "string"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "view",
                    "type": "function"
                },
                {
                    "constant": false,
                    "inputs": [
                        {
                            "internalType": "string",
                            "name": "_name",
                            "type": "string"
                        }
                    ],
                    "name": "setName",
                    "outputs": [
                        {
                            "internalType": "string",
                            "name": "",
                            "type": "string"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "nonpayable",
                    "type": "function"
                }
            ];
            let contract = new pw3.platon.Contract(contractAbi, 'atp17sjptvllj9g8fltvfq5ty3havhc0m8jr0e62j9', {
                from: 'atp17sjptvllj9g8fltvfq5ty3havhc0m8jr0e62j9', // default from address
                gasPrice: '20000000000' // default gas price in VON, 20 GVON in this case
            });
            console.log(contract.options);
            contract.options.data = "0x608060405234801561001057600080fd5b5061036b806100206000396000f3fe608060405234801561001057600080fd5b50600436106100365760003560e01c806317d7de7c1461003b578063c47f0027146100b8575b600080fd5b61004361015e565b6040805160208082528351818301528351919283929083019185019080838360005b8381101561007d578181015183820152602001610065565b50505050905090810190601f1680156100aa5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b610043600480360360208110156100ce57600080fd5b8101906020810181356401000000008111156100e957600080fd5b8201836020820111156100fb57600080fd5b8035906020019184600183028401116401000000008311171561011d57600080fd5b91908080601f0160208091040260200160405190810160405280939291908181526020018383808284376000920191909152509295506101f5945050505050565b60008054604080516020601f60026000196101006001881615020190951694909404938401819004810282018101909252828152606093909290918301828280156101ea5780601f106101bf576101008083540402835291602001916101ea565b820191906000526020600020905b8154815290600101906020018083116101cd57829003601f168201915b505050505090505b90565b805160609061020b90600090602085019061029e565b506000805460408051602060026001851615610100026000190190941693909304601f810184900484028201840190925281815292918301828280156102925780601f1061026757610100808354040283529160200191610292565b820191906000526020600020905b81548152906001019060200180831161027557829003601f168201915b50505050509050919050565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106102df57805160ff191683800117855561030c565b8280016001018555821561030c579182015b8281111561030c5782518255916020019190600101906102f1565b5061031892915061031c565b5090565b6101f291905b80821115610318576000815560010161032256fea265627a7a723158200476d6580c067d21480aaaff4a99fc439c61e88eb7f1425131be47f6f525c56564736f6c63430005110032";

            // myContract.options.data = '0x12345...';

            contract.deploy({
                data: "0x608060405234801561001057600080fd5b5061036b806100206000396000f3fe608060405234801561001057600080fd5b50600436106100365760003560e01c806317d7de7c1461003b578063c47f0027146100b8575b600080fd5b61004361015e565b6040805160208082528351818301528351919283929083019185019080838360005b8381101561007d578181015183820152602001610065565b50505050905090810190601f1680156100aa5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b610043600480360360208110156100ce57600080fd5b8101906020810181356401000000008111156100e957600080fd5b8201836020820111156100fb57600080fd5b8035906020019184600183028401116401000000008311171561011d57600080fd5b91908080601f0160208091040260200160405190810160405280939291908181526020018383808284376000920191909152509295506101f5945050505050565b60008054604080516020601f60026000196101006001881615020190951694909404938401819004810282018101909252828152606093909290918301828280156101ea5780601f106101bf576101008083540402835291602001916101ea565b820191906000526020600020905b8154815290600101906020018083116101cd57829003601f168201915b505050505090505b90565b805160609061020b90600090602085019061029e565b506000805460408051602060026001851615610100026000190190941693909304601f810184900484028201840190925281815292918301828280156102925780601f1061026757610100808354040283529160200191610292565b820191906000526020600020905b81548152906001019060200180831161027557829003601f168201915b50505050509050919050565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106102df57805160ff191683800117855561030c565b8280016001018555821561030c579182015b8281111561030c5782518255916020019190600101906102f1565b5061031892915061031c565b5090565b6101f291905b80821115610318576000815560010161032256fea265627a7a723158200476d6580c067d21480aaaff4a99fc439c61e88eb7f1425131be47f6f525c56564736f6c63430005110032"
            })
                .send({
                    from: 'atp17sjptvllj9g8fltvfq5ty3havhc0m8jr0e62j9',
                    gas: 1500000,
                    gasPrice: '30000000000000'
                })
                .then(function (newContractInstance) {
                    console.log(newContractInstance.options.address) // instance with the new contract address
                });
        }
    </script>
    <title>基础案例</title>
</head>

<body>
    <button onclick="checkAndConnect()">连接钱包</button>
    <button onclick="sendATP()">发送</button>
    <button onclick="getTransInfo()">获取事件信息</button>
</body>

</html>